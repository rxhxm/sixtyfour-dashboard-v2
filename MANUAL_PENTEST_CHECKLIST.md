# 🔐 Manual Penetration Test Checklist

## For Your Pentester to Verify:

### ✅ **Test 1: Unauthorized Sixtyfour Account**
**Steps:**
1. Open incognito window
2. Go to: dashboard.sixtyfour.ai  
3. Login with: `[pentester's @sixtyfour.ai email]` + password
4. **Expected:** Login succeeds in Supabase
5. **Expected:** Alert: "Access denied. Restricted to authorized team only."
6. **Expected:** Redirected back to signin
7. **Expected:** NEVER see dashboard content

**✅ PASS if:** No dashboard access, alert shown, forced signout  
**❌ FAIL if:** Dashboard loads with any content visible

---

### ✅ **Test 2: Direct URL Access**
**Steps:**
1. Open incognito (not logged in)
2. Try accessing these URLs directly:
   - dashboard.sixtyfour.ai/
   - dashboard.sixtyfour.ai/workflows
   - dashboard.sixtyfour.ai/credits-management
   - dashboard.sixtyfour.ai/platform-access

**✅ PASS if:** All immediately redirect to /auth/signin  
**❌ FAIL if:** Any page content loads

---

### ✅ **Test 3: Content Flash Check**
**Steps:**
1. Incognito window
2. Go to: dashboard.sixtyfour.ai
3. Watch very carefully for ANY flash of:
   - Sidebar (API Usage, Workflows links)
   - Header (Logout button)
   - Dashboard content
   - Organization names
   - Numbers/metrics

**✅ PASS if:** Only see blank/spinner, then signin page  
**❌ FAIL if:** Any dashboard element visible for even 1 frame

---

### ✅ **Test 4: API Direct Call (Postman/cURL)**
**Steps:**
1. Use Postman or curl
2. Try: `GET dashboard.sixtyfour.ai/api/credits`
3. Try: `POST dashboard.sixtyfour.ai/api/credits` with data

**✅ PASS if:** Returns 401/403/500 (not 200)  
**❌ FAIL if:** Returns data without auth

---

### ✅ **Test 5: Authorized Email (Positive Test)**
**Steps:**
1. Incognito window
2. Login with: `saarth@sixtyfour.ai` (or roham/chris)
3. **Expected:** Dashboard loads successfully
4. Can view all data
5. Can navigate between pages
6. Can see metrics

**✅ PASS if:** Full access granted  
**❌ FAIL if:** Access denied

---

### ✅ **Test 6: Session Persistence**
**Steps:**
1. Login as authorized user
2. Navigate to different pages
3. Refresh page
4. Close tab, reopen
5. **Expected:** Stay logged in

**✅ PASS if:** Session persists, no re-login needed  
**❌ FAIL if:** Forced to login again

---

### ✅ **Test 7: Logout**
**Steps:**
1. Login as authorized user
2. Click "Logout" button
3. **Expected:** Redirected to signin
4. Try accessing /workflows directly
5. **Expected:** Blocked, redirect to signin

**✅ PASS if:** Logout works, can't access pages after  
**❌ FAIL if:** Still can access pages after logout

---

### ✅ **Test 8: Browser DevTools Session Manipulation**
**Steps:**
1. Login as pentester (unauthorized email)
2. Before alert appears, open DevTools
3. Try to manipulate:
   - sessionStorage
   - localStorage  
   - Cookies
4. Try to bypass the email check

**✅ PASS if:** Cannot bypass, still blocked  
**❌ FAIL if:** Can manipulate way in

---

### ✅ **Test 9: Multiple Browsers**
**Steps:**
1. Chrome incognito: Try unauthorized login
2. Safari private: Try unauthorized login
3. Firefox private: Try unauthorized login

**✅ PASS if:** Blocked in all browsers  
**❌ FAIL if:** Works in any browser

---

### ✅ **Test 10: Credits API with Session**
**Steps:**
1. Login as pentester (unauthorized)
2. Before getting kicked out, try to call:
   ```javascript
   fetch('/api/credits', {
     method: 'POST',
     headers: {'Content-Type': 'application/json'},
     body: JSON.stringify({org_id:'test',amount:1000,operation:'add'})
   })
   ```

**✅ PASS if:** Returns 401/403, no credits modified  
**❌ FAIL if:** Credits modified

---

## 🎯 CRITICAL VULNERABILITIES TO CHECK:

### 🚨 **HIGH PRIORITY:**
- [ ] Can pentester see ANY data with unauthorized email?
- [ ] Can pentester modify credits with unauthorized email?
- [ ] Can pentester see customer org data?
- [ ] Does content flash before auth check?

### ⚠️ **MEDIUM PRIORITY:**
- [ ] Can pentester brute force login?
- [ ] Can pentester manipulate session?
- [ ] Can pentester bypass client-side checks?

### ℹ️ **LOW PRIORITY:**
- [ ] Does logout work properly?
- [ ] Does signin UI match main app?
- [ ] Are error messages informative but not leaking?

---

## 📊 SCORING:

**Each failed test = 1 critical vulnerability**

**Target:** 0 failures  
**Acceptable:** 0 failures  
**Unacceptable:** Any failure

---

## 🔒 CURRENT SECURITY MEASURES:

1. ✅ Middleware: Checks Supabase session + email whitelist
2. ✅ Page Guards: Block rendering until email verified
3. ✅ API Guards: Credits API checks whitelist
4. ✅ Hardcoded Whitelist: Only 3 emails in code
5. ✅ No Preloading: Data only loads after auth
6. ✅ httpOnly Cookies: XSS protection
7. ✅ SameSite Cookies: CSRF protection

---

## 📝 PENTESTER INSTRUCTIONS:

**Test each scenario above and report:**
1. Which tests PASSED ✅
2. Which tests FAILED ❌
3. Screenshots of any failures
4. Exact steps to reproduce any bypass

**Pay special attention to:**
- Data visibility (even for 1 frame)
- Credits modification ability
- Any error messages that leak info
- Console logs that expose sensitive data

---

**Ready for pentesting!** 🛡️

